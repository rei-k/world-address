# Kustomization for Staging Environment
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

namespace: world-address-staging

# Base resources
resources:
  - ../base/namespace.yaml
  - ../base/configmap.yaml
  - ../base/secrets.yaml
  - ../base/deployment.yaml
  - ../base/service.yaml
  - ../base/postgres.yaml
  - ../base/redis.yaml
  - ../base/hpa.yaml
  - ../base/ingress.yaml
  - ../base/rbac.yaml

# Staging-specific patches
patchesStrategicMerge:
  - deployment-patch.yaml

# ConfigMap generator for staging settings
configMapGenerator:
  - name: world-address-config
    behavior: merge
    literals:
      - NODE_ENV=staging
      - LOG_LEVEL=debug
      - ENABLE_ANALYTICS=false

# Image tag override
images:
  - name: world-address
    newName: ghcr.io/rei-k/world-address
    newTag: staging-latest

# Labels applied to all resources
commonLabels:
  environment: staging
  managed-by: kustomize

# Annotations applied to all resources
commonAnnotations:
  deployment.kubernetes.io/revision: "1"
